(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6896:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return a(3165)}])},9767:function(e,s,a){"use strict";a.d(s,{z:function(){return r}});var t=a(5893);function r(e){let{children:s,className:a="",variant:r="solid",size:i="md",...n}=e;return(0,t.jsx)("button",{className:"".concat("rounded-xl font-medium transition border"," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[i]," ").concat("outline"===r?"bg-white border-gray-300 hover:bg-gray-50":"bg-orange-500 text-white border-orange-600 hover:bg-orange-600"," ").concat(a),...n,children:s})}},9553:function(e,s,a){"use strict";a.d(s,{Z:function(){return r},a:function(){return i}});var t=a(5893);function r(e){let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"bg-white border shadow-sm rounded-2xl ".concat(a),children:s})}function i(e){let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"p-4 ".concat(a),children:s})}},4212:function(e,s,a){"use strict";a.d(s,{VU:function(){return l},le:function(){return n}});var t=a(310),r=a(9724);let i="tasteProfiles";async function n(e){if(!t.Wn)return console.warn("Firebase not configured. Returning default profile."),{userId:e,preferences:{quietness:50,serviceQuality:50,healthiness:50,value:50,atmosphere:50,cuisineTypes:[],priceRange:{min:10,max:100}},learningData:{totalRatings:0,averageRating:0,lastUpdated:new Date}};try{let s=(0,t.xI)(),a=(0,r.JU)(s,i,e),n=await (0,r.QT)(a);if(n.exists())return n.data();let l={userId:e,preferences:{quietness:50,serviceQuality:50,healthiness:50,value:50,atmosphere:50,cuisineTypes:[],priceRange:{min:10,max:100}},learningData:{totalRatings:0,averageRating:0,lastUpdated:new Date}};return await (0,r.pl)(a,l),l}catch(e){return console.error("Error getting taste profile:",e),null}}async function l(e,s){if(console.log("[updateTasteProfile] Starting...",{userId:e,preferences:s}),!t.Wn)throw console.error("[updateTasteProfile] Firebase not configured!"),Error("Firebase is not configured");try{let n=(0,t.xI)(),l=(0,t.yL)(),o=(0,r.JU)(n,i,e);console.log("[updateTasteProfile] Document reference created:",o.path);let c=null;try{console.log("[updateTasteProfile] Attempting to read existing profile...");let e=await Promise.race([(0,r.QT)(o),new Promise((e,s)=>setTimeout(()=>s(Error("timeout")),2e3))]);e&&e.exists()?(c=e.data(),console.log("[updateTasteProfile] Found existing profile:",c)):console.log("[updateTasteProfile] No existing profile found")}catch(e){console.warn("[updateTasteProfile] Could not read existing profile (may be offline):",e.message)}let{Timestamp:d}=await Promise.resolve().then(a.bind(a,9724)),u={userId:e,preferences:{...(null==c?void 0:c.preferences)||{quietness:50,serviceQuality:50,healthiness:50,value:50,atmosphere:50,cuisineTypes:[],priceRange:{min:10,max:100}},...s},learningData:{...(null==c?void 0:c.learningData)||{totalRatings:0,averageRating:0},lastUpdated:d.now()}};if(!l||!l.currentUser)throw Error("User must be authenticated to save taste profile");console.log("[updateTasteProfile] User authenticated:",l.currentUser.uid),console.log("[updateTasteProfile] Saving data:",u),console.log("[updateTasteProfile] Attempting setDoc with merge..."),await Promise.race([(0,r.pl)(o,u,{merge:!0}),new Promise((e,s)=>setTimeout(()=>s(Error("Write operation timed out after 30 seconds")),3e4))]),console.log("[updateTasteProfile] ✓ Successfully saved to Firebase!")}catch(e){var n;if(console.error("[updateTasteProfile] ✗ Full error object:",e),console.error("[updateTasteProfile] ✗ Error as JSON:",JSON.stringify(e,Object.getOwnPropertyNames(e),2)),console.error("[updateTasteProfile] ✗ Error details:",{message:e.message,code:e.code,serverResponse:e.serverResponse,name:e.name,stack:null===(n=e.stack)||void 0===n?void 0:n.substring(0,500)}),"permission-denied"===e.code||"PERMISSION_DENIED"===e.code)throw Error("Permission denied. Please ensure you are logged in and have permission to save this data.");if("unauthenticated"===e.code||"UNAUTHENTICATED"===e.code)throw Error("Authentication required. Please sign in and try again.");if("invalid-argument"===e.code||"INVALID_ARGUMENT"===e.code)throw Error("Invalid data format. Please check the data being saved.");if("unavailable"===e.code||"UNAVAILABLE"===e.code)throw Error("Firestore is currently unavailable. Please try again in a moment.");else if(e.message&&e.message.includes("timed out"))throw console.warn("[updateTasteProfile] Write timed out - may complete in background if online"),Error("Save operation timed out. Please check your connection and try again.");throw Error("Failed to save: ".concat(e.message||e.code||"Unknown error"))}}},3165:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Z}});var t=a(5893),r=a(9008),i=a.n(r),n=a(7294),l=a(1163),o=a(9553),c=a(9767),d=a(3416),u=a(5809),m=a(8154),x=a(2691),h=a(7963),g=a(5677),p=a(7218),f=a(6510),j=a(6314),y=a(2305),v=a(5035),N=a(8206),b=a(8756),w=a(3458),P=a(5390),E=a(4212),T=a(3949),R=a(6442);function U(e){var s;let{userId:a}=e,{user:r}=(0,R.a)(),i=(0,l.useRouter)(),[U,k]=(0,n.useState)(null),[S,Z]=(0,n.useState)(0),[F,D]=(0,n.useState)(!0),[A,C]=(0,n.useState)(!1),[_,I]=(0,n.useState)({displayName:(null==r?void 0:r.displayName)||(null==r?void 0:null===(s=r.email)||void 0===s?void 0:s.split("@")[0])||"User",email:(null==r?void 0:r.email)||"",bio:"Food enthusiast and business lunch connoisseur"}),[Q,z]=(0,n.useState)(_);async function O(){D(!0);try{let[e,s]=await Promise.all([(0,E.le)(a),(0,T.$J)(a)]);k(e),Z(s.length)}catch(e){console.error("Error loading profile:",e)}finally{D(!1)}}(0,n.useEffect)(()=>{if(r){var e,s;I({displayName:r.displayName||(null===(e=r.email)||void 0===e?void 0:e.split("@")[0])||"User",email:r.email||"",bio:"Food enthusiast and business lunch connoisseur"}),z({displayName:r.displayName||(null===(s=r.email)||void 0===s?void 0:s.split("@")[0])||"User",email:r.email||"",bio:"Food enthusiast and business lunch connoisseur"})}},[r]),(0,n.useEffect)(()=>{O()},[a]);let M=U?[{trait:"Quiet",score:U.preferences.quietness},{trait:"Service",score:U.preferences.serviceQuality},{trait:"Healthy",score:U.preferences.healthiness},{trait:"Atmosphere",score:U.preferences.atmosphere},{trait:"Value",score:U.preferences.value}]:[{trait:"Quiet",score:85},{trait:"Service",score:90},{trait:"Healthy",score:65},{trait:"Atmosphere",score:88},{trait:"Value",score:75}],V=(null==U?void 0:U.learningData)||{totalRatings:24,averageRating:4.2,lastUpdated:new Date};return(0,t.jsxs)("div",{className:"p-6 space-y-8 bg-gradient-to-b from-orange-50 to-white min-h-screen pb-24",children:[(0,t.jsxs)("header",{className:"text-center relative",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Profile"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage your taste preferences"})]}),(0,t.jsx)(j.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsx)(o.a,{children:(0,t.jsxs)("div",{className:"flex items-start gap-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-orange-400 to-purple-500 flex items-center justify-center text-white text-3xl font-bold",children:_.displayName.charAt(0).toUpperCase()}),!A&&(0,t.jsx)("button",{onClick:()=>C(!0),className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-md flex items-center justify-center hover:bg-gray-50 transition-colors",children:(0,t.jsx)(d.Z,{className:"w-4 h-4 text-gray-700"})})]}),(0,t.jsx)("div",{className:"flex-1",children:A?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Name"}),(0,t.jsx)("input",{type:"text",value:Q.displayName,onChange:e=>z({...Q,displayName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,t.jsx)("input",{type:"email",value:Q.email,onChange:e=>z({...Q,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),(0,t.jsx)("textarea",{value:Q.bio,onChange:e=>z({...Q,bio:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.z,{onClick:()=>{I(Q),C(!1)},size:"sm",className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"Save"]}),(0,t.jsxs)(c.z,{onClick:()=>{z(_),C(!1)},size:"sm",className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-1",children:_.displayName}),(0,t.jsx)("p",{className:"text-gray-600 mb-2",children:_.email}),(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:_.bio})]})})]})})})}),(0,t.jsx)(j.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsx)(o.a,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(x.Z,{className:"w-6 h-6 text-orange-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:V.totalRatings}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Restaurants Rated"})]})]})})}),(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsx)(o.a,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(x.Z,{className:"w-6 h-6 text-blue-500 fill-blue-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:V.averageRating.toFixed(1)}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Average Rating"})]})]})})}),(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsx)(o.a,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(h.Z,{className:"w-6 h-6 text-green-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:S}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Friends"})]})]})})})]})}),(0,t.jsx)(j.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsxs)(o.a,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Your Taste Profile"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["Updated ",V.lastUpdated?new Date(V.lastUpdated).toLocaleDateString():"recently"]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 items-center",children:[(0,t.jsx)("div",{className:"md:col-span-2 h-72",children:F?(0,t.jsx)("div",{className:"w-full h-full bg-gray-100 animate-pulse rounded-lg"}):(0,t.jsx)(y.h,{width:"100%",height:"100%",children:(0,t.jsxs)(v.H,{data:M,cx:"50%",cy:"50%",outerRadius:"80%",children:[(0,t.jsx)(N.n,{}),(0,t.jsx)(b.I,{dataKey:"trait"}),(0,t.jsx)(w.S,{angle:30,domain:[0,100]}),(0,t.jsx)(P.F,{name:"Preferences",dataKey:"score",stroke:"#fb923c",fill:"#fb923c",fillOpacity:.3})]})})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Quietness"}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"".concat(M[0].score,"%")}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[M[0].score,"/100"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Service Quality"}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(M[1].score,"%")}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[M[1].score,"/100"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Healthiness"}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(M[2].score,"%")}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[M[2].score,"/100"]})]}),(0,t.jsx)(c.z,{size:"sm",className:"w-full mt-4 bg-orange-500 hover:bg-orange-600 text-white",children:"Edit Preferences"})]})]})]})})}),(0,t.jsx)(j.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsxs)(o.a,{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Preferences"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Price Range"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["$",(null==U?void 0:U.preferences.priceRange.min)||10," - $",(null==U?void 0:U.preferences.priceRange.max)||100," per person"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preferred Cuisines"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:(null==U?void 0:U.preferences.cuisineTypes)&&U.preferences.cuisineTypes.length>0?U.preferences.cuisineTypes.map((e,s)=>(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:e},s)):(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"No preferences set yet"})})]})]})]})})}),(0,t.jsx)(j.E.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},children:(0,t.jsx)(o.Z,{className:"shadow-md rounded-2xl p-4",children:(0,t.jsxs)(o.a,{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(c.z,{onClick:()=>i.push("/my-list"),className:"justify-start bg-orange-500 hover:bg-orange-600 text-white",children:[(0,t.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"View My Favorites"]}),(0,t.jsxs)(c.z,{onClick:()=>i.push("/friends"),className:"justify-start bg-orange-500 hover:bg-orange-600 text-white",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Manage Friends"]}),(0,t.jsxs)(c.z,{className:"justify-start bg-orange-500 hover:bg-orange-600 text-white",children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"My Meetings"]})]})]})})}),(0,t.jsx)(f.Z,{})]})}var k=a(5993);function S(){let{user:e}=(0,R.a)();return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i(),{children:[(0,t.jsx)("title",{children:"Profile - Nexus Nosh"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("meta",{name:"description",content:"Your Nexus Nosh profile and preferences"})]}),(0,t.jsx)("main",{children:(0,t.jsx)(U,{userId:e.uid})})]}):null}function Z(){return(0,t.jsx)(k.Z,{children:(0,t.jsx)(S,{})})}}},function(e){e.O(0,[224,387,843,888,774,179],function(){return e(e.s=6896)}),_N_E=e.O()}]);