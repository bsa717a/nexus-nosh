(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[484],{1017:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/clean-restaurants",function(){return a(5193)}])},9767:function(e,t,a){"use strict";a.d(t,{z:function(){return n}});var s=a(5893);function n(e){let{children:t,className:a="",variant:n="solid",size:l="md",...r}=e;return(0,s.jsx)("button",{className:"".concat("rounded-xl font-medium transition border"," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[l]," ").concat("outline"===n?"bg-white border-gray-300 hover:bg-gray-50":"bg-orange-500 text-white border-orange-600 hover:bg-orange-600"," ").concat(a),...r,children:t})}},9553:function(e,t,a){"use strict";a.d(t,{Z:function(){return n},a:function(){return l}});var s=a(5893);function n(e){let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"bg-white border shadow-sm rounded-2xl ".concat(a),children:t})}function l(e){let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"p-4 ".concat(a),children:t})}},5193:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(5893),n=a(7294),l=a(1163),r=a(9767),i=a(9553),c=a(6442),o=a(310),d=a(9724);function u(){let e=(0,l.useRouter)(),{user:t}=(0,c.a)(),[a,u]=(0,n.useState)(!1),[h,m]=(0,n.useState)(""),[f,x]=(0,n.useState)(null);async function g(){u(!0),m("");try{let e=(0,o.xI)();if(!e){m("Firebase not initialized");return}let t=(0,d.hJ)(e,"restaurants"),a=await (0,d.PL)(t),s=new Map;a.docs.forEach(e=>{let t=e.data().name;s.has(t)||s.set(t,[]),s.get(t).push(e.id)});let n=a.docs.length,l=s.size,r=n-l;x({total:n,unique:l,duplicates:r}),r>0?m("Found ".concat(r," duplicate restaurants out of ").concat(n," total.")):m("No duplicates found! You have ".concat(n," unique restaurants."))}catch(e){m("Error: ".concat(e.message))}finally{u(!1)}}async function b(){if(confirm("This will delete duplicate restaurants, keeping only one of each. Continue?")){u(!0),m("");try{let e=(0,o.xI)();if(!e){m("Firebase not initialized");return}let t=(0,d.hJ)(e,"restaurants"),a=await (0,d.PL)(t),s=new Map;a.docs.forEach(e=>{let t=e.data().name;s.has(t)||s.set(t,[]),s.get(t).push(e.id)});let n=0,l=(0,d.qs)(e);s.forEach((t,a)=>{if(t.length>1){console.log("".concat(a,": Found ").concat(t.length," copies, keeping first, deleting ").concat(t.length-1));for(let a=1;a<t.length;a++)l.delete((0,d.JU)(e,"restaurants",t[a])),n++}}),await l.commit(),m("Successfully removed ".concat(n," duplicate restaurants!")),x(null),setTimeout(()=>g(),1e3)}catch(e){m("Error: ".concat(e.message))}finally{u(!1)}}}async function p(){if(confirm("⚠️ This will DELETE ALL restaurants from the database! Are you absolutely sure?")){u(!0),m("");try{let e=(0,o.xI)();if(!e){m("Firebase not initialized");return}let t=(0,d.hJ)(e,"restaurants"),a=await (0,d.PL)(t),s=(0,d.qs)(e);a.docs.forEach(t=>{s.delete((0,d.JU)(e,"restaurants",t.id))}),await s.commit(),m("Successfully deleted all ".concat(a.docs.length," restaurants!")),x(null)}catch(e){m("Error: ".concat(e.message))}finally{u(!1)}}}return t?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-white p-6",children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,s.jsx)(i.Z,{children:(0,s.jsxs)(i.a,{className:"p-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Clean Restaurant Database"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Remove duplicate restaurants from the database."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(r.z,{onClick:g,disabled:a,className:"w-full",variant:"outline",children:a?"Analyzing...":"Analyze Database"}),f&&(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Database Statistics:"}),(0,s.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("li",{children:["Total restaurants: ",f.total]}),(0,s.jsxs)("li",{children:["Unique restaurants: ",f.unique]}),(0,s.jsxs)("li",{className:"text-red-600 font-semibold",children:["Duplicates: ",f.duplicates]})]})]}),f&&f.duplicates>0&&(0,s.jsx)(r.z,{onClick:b,disabled:a,className:"w-full bg-orange-500 hover:bg-orange-600",children:a?"Removing Duplicates...":"Remove Duplicates"}),(0,s.jsxs)("div",{className:"border-t pt-4 mt-6",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Danger Zone: Delete all restaurants (you'll need to re-seed after this)"}),(0,s.jsx)(r.z,{onClick:p,disabled:a,className:"w-full bg-red-500 hover:bg-red-600",variant:"outline",children:a?"Deleting All...":"Delete All Restaurants"})]}),h&&(0,s.jsx)("div",{className:"p-4 rounded-lg ".concat(h.includes("Error")?"bg-red-50 text-red-800":"bg-green-50 text-green-800"),children:h}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(r.z,{onClick:()=>e.push("/"),variant:"outline",className:"flex-1",children:"Back to Dashboard"}),(0,s.jsx)(r.z,{onClick:()=>e.push("/admin/seed-restaurants"),variant:"outline",className:"flex-1",children:"Go to Seed Page"})]})]})]})})})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(i.Z,{children:(0,s.jsxs)(i.a,{className:"p-8",children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Please log in to access admin tools."}),(0,s.jsx)(r.z,{onClick:()=>e.push("/login"),className:"mt-4",children:"Go to Login"})]})})})}},1163:function(e,t,a){e.exports=a(9090)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1017)}),_N_E=e.O()}]);