"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{9211:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(5893),n=r(7294),o=r(5197),s=r(1692),i=r(6442),l=r(3876);function c(e){let{restaurantId:t,restaurant:r,className:c="",size:d="md",showLabel:u=!1}=e,{user:p}=(0,i.a)(),[x,h]=(0,n.useState)(!1),[g,m]=(0,n.useState)(!0),[f,b]=(0,n.useState)(!1),[y,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{p?w():m(!1)},[p,t]);let w=async()=>{if(!p){m(!1);return}try{let e=await (0,l.kN)(p.uid,t);h(e)}catch(e){console.error("Error checking list status:",e)}finally{m(!1)}},j=async e=>{if(e.stopPropagation(),e.preventDefault(),!p){console.warn("[AddToListButton] User not authenticated"),alert("Please log in to add restaurants to your list");return}if(f){console.log("[AddToListButton] Already saving, ignoring click");return}console.log("[AddToListButton] Toggling list status for restaurant:",t,"currently in list:",x,"user:",p.uid),b(!0),v(null);try{if(x)console.log("[AddToListButton] Removing from list..."),await (0,l.J4)(p.uid,t),h(!1),console.log("[AddToListButton] Successfully removed from list");else{console.log("[AddToListButton] Adding to list...");let e=r?{name:r.name,address:r.address,coordinates:r.coordinates,cuisineType:r.cuisineType}:void 0;await (0,l.Gy)(p.uid,t,e),h(!0),console.log("[AddToListButton] Successfully added to list")}}catch(t){console.error("[AddToListButton] Error toggling list status:",t);let e=(null==t?void 0:t.message)||"Unknown error occurred";v(e),alert("Failed to ".concat(x?"remove from":"add to"," list: ").concat(e))}finally{b(!1)}},N={sm:"w-6 h-6",md:"w-8 h-8",lg:"w-10 h-10"},I={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return g?(0,a.jsx)("div",{className:"".concat(N[d]," flex items-center justify-center"),children:(0,a.jsx)(o.Z,{className:"".concat(I[d]," animate-spin text-gray-400")})}):p?(0,a.jsxs)("button",{onClick:j,disabled:f,type:"button",className:"\n        ".concat(N[d],"\n        flex items-center justify-center\n        rounded-full transition-all duration-200\n        ").concat(x?"bg-red-500 hover:bg-red-600 text-white":"bg-white hover:bg-red-50 text-gray-400 hover:text-red-500 border border-gray-200","\n        ").concat(f?"opacity-50 cursor-not-allowed":"cursor-pointer","\n        ").concat(c,"\n      "),title:x?"Remove from list":"Add to list",style:{zIndex:10},children:[f?(0,a.jsx)(o.Z,{className:"".concat(I[d]," animate-spin")}):(0,a.jsx)(s.Z,{className:"".concat(I[d]," ").concat(x?"fill-current":"")}),u&&(0,a.jsx)("span",{className:"ml-2 text-sm",children:x?"In List":"Add to List"})]}):null}},5793:function(e,t,r){var a=r(5893),n=r(7294),o=r(1108),s=r(1692),i=r(718),l=r(9455),c=r(5677),d=r(898),u=r(2691),p=r(9211);let x=(0,n.forwardRef)((e,t)=>{var r;let{recommendations:x=[],restaurants:h=[],center:g,userLocation:m,myListIds:f=new Set,friendsListIds:b=new Set,height:y="400px",onRestaurantSelect:v,onBoundsChange:w,onCenterChange:j,onRestaurantInfoClick:N}=e,I="pk.eyJ1IjoiYnNhNzE3IiwiYSI6ImNtaG13YnZvczIxcHIybXB1N2E0NnJpcHcifQ.Z-AeF3-pt2ihl2uz71Lvxg",[S,M]=(0,n.useState)(null),k=(0,n.useRef)(null),_=(0,n.useMemo)(()=>x.length>0?x:h.map(e=>({restaurant:e,matchScore:0,matchType:"all-restaurants",reasons:[],friendRecommendations:[]})),[x,h]),A=(0,n.useRef)(_);(0,n.useEffect)(()=>{A.current=_},[_]);let L=(0,n.useRef)(w);(0,n.useEffect)(()=>{L.current=w},[w]);let R=(0,n.useRef)(j);(0,n.useEffect)(()=>{R.current=j},[j]);let T=(0,n.useCallback)(()=>{if(!k.current)return;let e=k.current.getMap(),t=e.getBounds(),r=e.getCenter();if(t&&(R.current&&r&&R.current({lat:r.lat,lng:r.lng}),L.current)){let e=A.current.filter(e=>{let{lat:r,lng:a}=e.restaurant.coordinates;return t.contains([a,r])}).map(e=>e.restaurant);L.current(e)}},[]),C=(0,n.useCallback)(()=>{var e;let t=null===(e=k.current)||void 0===e?void 0:e.getMap();if(t){let e=t.getStyle();e&&e.layers&&e.layers.forEach(e=>{(e.id.includes("poi-label")||e.id.includes("poi")||e.id.includes("place-label"))&&t.setLayoutProperty(e.id,"visibility","none")}),setTimeout(()=>{L.current&&A.current.length>0&&T()},100)}},[T]),E=g||{lat:37.0965,lng:-113.5684};(0,n.useEffect)(()=>{k.current&&g&&k.current.flyTo({center:[g.lng,g.lat],zoom:13,duration:1500})},[null==g?void 0:g.lat,null==g?void 0:g.lng]),(0,n.useImperativeHandle)(t,()=>({focusRestaurant:e=>{let t=_.find(t=>t.restaurant.id===e);t&&k.current&&(k.current.flyTo({center:[t.restaurant.coordinates.lng,t.restaurant.coordinates.lat],zoom:15,duration:1e3}),M(t.restaurant))}}),[_]);let P=e=>f.has(e.id)?"myList":b.has(e.id)?"friendsList":"other",Z=e=>{switch(e){case"myList":return(0,a.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,a.jsx)("div",{className:"w-9 h-9 bg-white rounded-full shadow-lg border-2 border-rose-200 flex items-center justify-center",children:(0,a.jsx)(s.Z,{className:"w-5 h-5 text-rose-500 fill-rose-500"})}),(0,a.jsx)("div",{className:"absolute -bottom-1 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-white",style:{filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.1))"}})]});case"friendsList":return(0,a.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,a.jsx)("div",{className:"w-9 h-9 bg-white rounded-full shadow-lg border-2 border-teal-200 flex items-center justify-center",children:(0,a.jsx)(i.Z,{className:"w-5 h-5 text-teal-500 fill-teal-100"})}),(0,a.jsx)("div",{className:"absolute -bottom-1 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-white",style:{filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.1))"}})]});default:return(0,a.jsx)("div",{className:"relative flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-7 h-7 bg-white/90 rounded-full shadow-md border border-blue-200 flex items-center justify-center",children:(0,a.jsx)(l.Z,{className:"w-4 h-4 text-blue-500"})})})}};return I?(0,a.jsxs)("div",{className:"w-full overflow-hidden rounded-xl border",style:{height:y},children:[(0,a.jsxs)(o.ZP,{ref:k,initialViewState:{latitude:E.lat,longitude:E.lng,zoom:13},style:{width:"100%",height:"100%"},mapStyle:"mapbox://styles/mapbox/streets-v12",mapboxAccessToken:I,onLoad:C,onMoveEnd:T,onZoomEnd:T,children:[(0,a.jsx)(o.Pv,{position:"top-left"}),0===_.length&&(0,a.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:1,textAlign:"center"},children:[(0,a.jsx)(c.Z,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-1",children:"No restaurants found"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Try adjusting your filters or location"})]}),_.map(e=>{let t=P(e.restaurant);return(0,a.jsx)(o.Jx,{latitude:e.restaurant.coordinates.lat,longitude:e.restaurant.coordinates.lng,anchor:"bottom",onClick:()=>M(e.restaurant),children:(0,a.jsx)("div",{className:"cursor-pointer transform hover:scale-110 transition-transform",title:e.restaurant.name,children:Z(t)})},e.restaurant.id)}),m&&(0,a.jsx)(o.Jx,{latitude:m.lat,longitude:m.lng,anchor:"center",children:(0,a.jsxs)("div",{className:"relative",title:"You are here",children:[(0,a.jsx)("div",{className:"absolute inset-0 w-8 h-8 bg-blue-400/30 rounded-full animate-ping"}),(0,a.jsx)("div",{className:"relative w-8 h-8 flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-blue-400 rounded-full border-2 border-white shadow-lg flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-3 h-3 text-white",style:{transform:"rotate(45deg)"}})})})]})}),S&&(0,a.jsx)(o.GI,{latitude:S.coordinates.lat,longitude:S.coordinates.lng,anchor:"bottom",onClose:()=>M(null),closeButton:!0,closeOnClick:!1,className:"mapbox-popup",children:(0,a.jsxs)("div",{className:"p-2 min-w-[200px]",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 flex-1",children:S.name}),(0,a.jsx)("div",{className:"ml-2 flex-shrink-0",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(p.Z,{restaurantId:S.id,restaurant:S,size:"sm"})})]}),(null===(r=S.rating)||void 0===r?void 0:r.average)!==void 0&&S.rating.average>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-yellow-500 mb-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 fill-yellow-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:S.rating.average.toFixed(1)}),void 0!==S.rating.count&&S.rating.count>0&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["(",S.rating.count,")"]})]}),(0,a.jsx)("a",{href:"https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent(S.address)),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-orange-600 hover:text-orange-700 hover:underline mb-2 block",children:S.address}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:S.cuisineType&&Array.isArray(S.cuisineType)&&S.cuisineType.slice(0,2).map(e=>(0,a.jsx)("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded-full",children:e},e))}),S.priceRange&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["$",S.priceRange.min," - $",S.priceRange.max]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),N&&N(S)},className:"w-full mt-2 bg-orange-50 text-orange-600 text-xs font-medium py-1.5 rounded hover:bg-orange-100 transition-colors",children:"More Info & Menu"})]})})]}),(0,a.jsxs)("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:"white",padding:"10px 14px",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:"12px",zIndex:1},children:[(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:"8px",color:"#374151",fontSize:"13px"},children:"Legend"}),m&&(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"6px"},children:[(0,a.jsx)("div",{style:{width:"18px",height:"18px",backgroundColor:"#60a5fa",borderRadius:"50%",marginRight:"8px",border:"2px solid white",boxShadow:"0 1px 3px rgba(0,0,0,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(d.Z,{style:{width:"10px",height:"10px",color:"white",transform:"rotate(45deg)"}})}),(0,a.jsx)("span",{style:{color:"#6b7280"},children:"You"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"6px"},children:[(0,a.jsx)("div",{style:{width:"18px",height:"18px",backgroundColor:"white",borderRadius:"50%",marginRight:"8px",border:"2px solid #fecdd3",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(s.Z,{style:{width:"10px",height:"10px",color:"#f43f5e",fill:"#f43f5e"}})}),(0,a.jsx)("span",{style:{color:"#6b7280"},children:"My List"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"6px"},children:[(0,a.jsx)("div",{style:{width:"18px",height:"18px",backgroundColor:"white",borderRadius:"50%",marginRight:"8px",border:"2px solid #99f6e4",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(i.Z,{style:{width:"10px",height:"10px",color:"#14b8a6"}})}),(0,a.jsx)("span",{style:{color:"#6b7280"},children:"Friend's List"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)("div",{style:{width:"18px",height:"18px",backgroundColor:"white",borderRadius:"50%",marginRight:"8px",border:"1px solid #bfdbfe",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(l.Z,{style:{width:"10px",height:"10px",color:"#3b82f6"}})}),(0,a.jsx)("span",{style:{color:"#6b7280"},children:"Other"})]})]})]}):(0,a.jsx)("div",{className:"w-full bg-white border rounded-xl flex items-center justify-center text-gray-600",style:{height:y},children:(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:"Mapbox token missing"}),(0,a.jsxs)("div",{className:"text-sm",children:["Add ",(0,a.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"NEXT_PUBLIC_MAPBOX_TOKEN"})," to your ",(0,a.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded",children:".env.local"})," file"]}),(0,a.jsxs)("div",{className:"text-xs mt-2 text-gray-500",children:["Get a free token at"," ",(0,a.jsx)("a",{href:"https://account.mapbox.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"mapbox.com"})]})]})})});x.displayName="MapView",t.Z=x},9767:function(e,t,r){r.d(t,{z:function(){return n}});var a=r(5893);function n(e){let{children:t,className:r="",variant:n="solid",size:o="md",...s}=e;return(0,a.jsx)("button",{className:"".concat("rounded-xl font-medium transition border"," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[o]," ").concat("outline"===n?"bg-white border-gray-300 hover:bg-gray-50":"bg-orange-500 text-white border-orange-600 hover:bg-orange-600"," ").concat(r),...s,children:t})}},4027:function(e,t,r){r.d(t,{$y:function(){return o},Mw:function(){return s},Y2:function(){return n}});let a="pk.eyJ1IjoiYnNhNzE3IiwiYSI6ImNtaG13YnZvczIxcHIybXB1N2E0NnJpcHcifQ.Z-AeF3-pt2ihl2uz71Lvxg";async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;try{var n;if(console.log("[MapboxSearch] Searching restaurants near:",e,"radius:",t),!a)return console.error("[MapboxSearch] No API token found!"),[];let o="".concat(e.lng,",").concat(e.lat),s="https://api.mapbox.com/search/searchbox/v1/category/restaurant?access_token=".concat(a,"&proximity=").concat(o,"&limit=").concat(Math.min(r,25),"&language=en");console.log("[MapboxSearch] Fetching from Mapbox Search Box API...");let i=await fetch(s,{headers:{Accept:"application/json"}});if(!i.ok){let e=await i.text();return console.error("[MapboxSearch] API error:",i.status,i.statusText,e),[]}let l=await i.json();console.log("[MapboxSearch] Received features:",(null===(n=l.features)||void 0===n?void 0:n.length)||0);let c=(l.features||[]).map(r=>{try{var a,n,o,s;let[i,l]=r.geometry.coordinates,c=function(e,t,r,a){let n=(r-e)*Math.PI/180,o=(a-t)*Math.PI/180,s=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371}(e.lat,e.lng,l,i);if(c>t/1e3)return null;let d=r.properties.full_address||r.properties.place_formatted||r.properties.address||"".concat((null===(n=r.properties.context)||void 0===n?void 0:null===(a=n.place)||void 0===a?void 0:a.name)||"",", ").concat((null===(s=r.properties.context)||void 0===s?void 0:null===(o=s.region)||void 0===o?void 0:o.region_code)||"").trim(),u=r.properties.poi_category||[],p=u.length>0?u.slice(0,3):["Restaurant"];return{id:"mapbox-".concat(r.properties.mapbox_id),name:r.properties.name_preferred||r.properties.name,address:d,coordinates:{lat:l,lng:i},cuisineType:p,source:"mapbox",rating:void 0!==r.properties.review_score?{average:r.properties.review_score,count:r.properties.review_count||0}:void 0,attributes:c<1?{walkableDistance:!0}:void 0}}catch(e){return console.error("[MapboxSearch] Error parsing feature:",e,r),null}}).filter(e=>null!==e);return console.log("[MapboxSearch] Converted to restaurants:",c.length),c}catch(e){return console.error("[MapboxSearch] Error searching restaurants:",e),[]}}async function o(e){try{if(!a)return console.error("[MapboxSearch] No API token found!"),null;let t=e.trim();if(!t||t.length<3)return null;let r=encodeURIComponent("".concat(t," USA")),n="https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(r,".json?types=postcode&limit=1&access_token=").concat(a),o=await fetch(n,{headers:{Accept:"application/json"}});if(!o.ok)return console.error("[MapboxSearch] Geocoding error:",o.status,o.statusText),null;let s=await o.json();if(!s.features||0===s.features.length)return console.warn("[MapboxSearch] No results for ZIP code:",t),null;let[i,l]=s.features[0].center;return{lat:l,lng:i}}catch(e){return console.error("[MapboxSearch] Error geocoding ZIP code:",e),null}}async function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var n,o,s,i;if(console.log("[MapboxSearch] Searching restaurants by name:",e),!a)return console.error("[MapboxSearch] No API token found!"),[];if(!e||0===e.trim().length)return[];let l=encodeURIComponent(e.trim()),c="https://api.mapbox.com/search/searchbox/v1/forward?access_token=".concat(a,"&q=").concat(l,"&limit=").concat(Math.min(r,10),"&language=en&types=poi");if(t){let e="".concat(t.lng,",").concat(t.lat);c+="&proximity=".concat(e)}console.log("[MapboxSearch] Fetching from Mapbox Search Box API...",c);let d=await fetch(c,{headers:{Accept:"application/json"}});if(!d.ok){let e=await d.text();return console.error("[MapboxSearch] API error:",d.status,d.statusText,e),[]}let u=await d.json();console.log("[MapboxSearch] Received features:",(null===(n=u.features)||void 0===n?void 0:n.length)||0),console.log("[MapboxSearch] Sample feature:",null===(o=u.features)||void 0===o?void 0:o[0]);let p=u.features||[];console.log("[MapboxSearch] Total features before filtering:",p.length);let x=p.filter(e=>{let t=e.properties.poi_category||[],r=e.properties.poi_category_ids||[];return t.some(e=>{let t=e.toLowerCase();return t.includes("restaurant")||t.includes("food")||t.includes("cafe")||t.includes("dining")||t.includes("bakery")||t.includes("bar")||t.includes("pizza")||t.includes("fast food")})||r.some(e=>{let t=e.toLowerCase();return t.includes("restaurant")||t.includes("food")||t.includes("cafe")||t.includes("dining")||t.includes("bakery")||t.includes("bar")||t.includes("pizza")||t.includes("fast_food")})}).map(e=>{try{var t,r,a,n;let[o,s]=e.geometry.coordinates,i=e.properties.full_address||e.properties.place_formatted||e.properties.address||"".concat((null===(r=e.properties.context)||void 0===r?void 0:null===(t=r.place)||void 0===t?void 0:t.name)||"",", ").concat((null===(n=e.properties.context)||void 0===n?void 0:null===(a=n.region)||void 0===a?void 0:a.region_code)||"").trim(),l=e.properties.poi_category||[],c=l.length>0?l.slice(0,3):["Restaurant"];return{id:"mapbox-".concat(e.properties.mapbox_id),name:e.properties.name_preferred||e.properties.name,address:i,coordinates:{lat:s,lng:o},cuisineType:c,source:"mapbox",rating:void 0!==e.properties.review_score?{average:e.properties.review_score,count:e.properties.review_count||0}:void 0}}catch(t){return console.error("[MapboxSearch] Error parsing feature:",t,e),null}}).filter(e=>null!==e);return console.log("[MapboxSearch] Converted to restaurants:",x.length),console.log("[MapboxSearch] Restaurant names:",x.map(e=>e.name)),0===x.length&&p.length>0&&(console.warn("[MapboxSearch] No restaurants found after filtering, but",p.length,"features were returned"),console.warn("[MapboxSearch] Sample feature categories:",null===(i=p[0])||void 0===i?void 0:null===(s=i.properties)||void 0===s?void 0:s.poi_category)),x}catch(e){return console.error("[MapboxSearch] Error searching restaurants:",e),[]}}},7816:function(e,t,r){r.d(t,{GY:function(){return s}});var a=r(310),n=r(9724);let o="restaurants";async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1?arguments[1]:void 0,r=(0,a.xI)();if(!a.Wn||!r)return console.error("[restaurantService] Firebase not configured or DB not initialized!"),[];try{let a;console.log("[restaurantService] Fetching all restaurants, limit:",e),a=t?(0,n.IO)((0,n.hJ)(r,o),(0,n.ar)("cuisineType","array-contains",t),(0,n.b9)(e)):(0,n.IO)((0,n.hJ)(r,o),(0,n.b9)(e));let s=(await (0,n.PL)(a)).docs.map(e=>({id:e.id,...e.data()}));return console.log("[restaurantService] Fetched restaurants:",s.length,s),s}catch(e){return console.error("[restaurantService] Error getting restaurants:",e),[]}}},3876:function(e,t,r){r.d(t,{EI:function(){return i},Gy:function(){return l},J4:function(){return c},j8:function(){return s},kN:function(){return d}});var a=r(310),n=r(9724);let o="userLists";async function s(e){if(!a.Wn)return console.warn("[getUserListIds] Firebase not configured. Returning empty array."),[];let t=(0,a.xI)();if(!t)return[];try{let r=(0,n.IO)((0,n.hJ)(t,o),(0,n.ar)("userId","==",e));return(await (0,n.PL)(r)).docs.map(e=>e.data().restaurantId)}catch(e){return console.error("[getUserListIds] Failed to fetch list:",e),[]}}async function i(e){if(!a.Wn)return console.warn("[getUserListRestaurants] Firebase not configured. Returning empty array."),[];let t=(0,a.xI)();if(!t)return[];try{let r=(0,n.IO)((0,n.hJ)(t,o),(0,n.ar)("userId","==",e)),a=await (0,n.PL)(r),s=[];for(let e of a.docs){let t=e.data(),r=t.restaurantId;t.restaurantName&&t.restaurantAddress&&t.restaurantCoordinates&&t.restaurantCuisineType?s.push({id:r,name:t.restaurantName,address:t.restaurantAddress,coordinates:t.restaurantCoordinates,cuisineType:t.restaurantCuisineType,source:r.startsWith("mapbox-")?"mapbox":"database"}):console.warn("[getUserListRestaurants] Skipping restaurant without stored data:",r)}return s}catch(e){return console.error("[getUserListRestaurants] Failed to fetch list:",e),[]}}async function l(e,t,r){if(!a.Wn)throw Error("Firebase is not configured");let s=(0,a.yL)();if(!s||!s.currentUser||s.currentUser.uid!==e)throw Error("User must be authenticated to add restaurants to list");let i=(0,a.xI)();if(!i)throw Error("Database not initialized");let l=(0,n.JU)(i,o,"".concat(e,"_").concat(t)),c={userId:e,restaurantId:t,addedAt:n.Timestamp.now()};r&&(r.name&&(c.restaurantName=r.name),r.address&&(c.restaurantAddress=r.address),r.coordinates&&(c.restaurantCoordinates=r.coordinates),r.cuisineType&&(c.restaurantCuisineType=r.cuisineType)),await (0,n.pl)(l,c,{merge:!0})}async function c(e,t){if(!a.Wn)throw Error("Firebase is not configured");let r=(0,a.yL)();if(!r||!r.currentUser||r.currentUser.uid!==e)throw Error("User must be authenticated to remove restaurants from list");let s=(0,a.xI)();if(!s)throw Error("Database not initialized");let i=(0,n.JU)(s,o,"".concat(e,"_").concat(t));await (0,n.oe)(i)}async function d(e,t){return(await s(e)).includes(t)}}}]);